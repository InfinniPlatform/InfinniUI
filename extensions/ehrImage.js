function EhrImage() {
    this.render = function (target, parameters, context) {
        var timer;
        var openView = function () {
            context.Global.executeAction({
                OpenViewAction: {
                    View: {
                        AutoView: {
                            ConfigId: 'PatientEhr',
                            DocumentId: 'Common',
                            MetadataName: 'ResearchHistory',
                            OpenMode: 'Dialog',
                            Parameters: {
                                Patient: context.DataSources['HospitalizationHistoryDataSource'].getSelectedItem().Patient
                            }
                        }
                    }
                }
            });
        };

        var $image = $('<a>')
            .css('cursor', 'pointer')
            .on('click dblclick', function () {
                window.clearTimeout(timer);
                timer = window.setTimeout(openView, 300);
                return false;
            })
            .append($('<img>')
                .attr('src', 'data:image/png;base64,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')
                .css('height', '17px'));

        target.append($image);
    }
}